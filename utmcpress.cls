﻿﻿%%
%% This is file `jsbook.cls',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% jsclasses.dtx  (with options: `book')
%% 
%% IMPORTANT NOTICE:
%% 
%% For the copyright see the source file.
%% 
%% Any modified versions of this file must be renamed
%% with new filenames distinct from jsbook.cls.
%% 
%% For distribution of the original source see the terms
%% for copying and modification in the file jsclasses.dtx.
%% 
%% This generated file may be distributed as long as the
%% original source files, as listed above, are part of the
%% same distribution. (The sources need not necessarily be
%% in the same archive or directory.)
%% \CharacterTable
%%  {Upper-case    \A\B\C\D\E\F\G\H\I\J\K\L\M\N\O\P\Q\R\S\T\U\V\W\X\Y\Z
%%   Lower-case    \a\b\c\d\e\f\g\h\i\j\k\l\m\n\o\p\q\r\s\t\u\v\w\x\y\z
%%   Digits        \0\1\2\3\4\5\6\7\8\9
%%   Exclamation   \!     Double quote  \"     Hash (number) \#
%%   Dollar        \$     Percent       \%     Ampersand     \&
%%   Acute accent  \'     Left paren    \(     Right paren   \)
%%   Asterisk      \*     Plus          \+     Comma         \,
%%   Minus         \-     Point         \.     Solidus       \/
%%   Colon         \:     Semicolon     \;     Less than     \<
%%   Equals        \=     Greater than  \>     Question mark \?
%%   Commercial at \@     Left bracket  \[     Backslash     \\
%%   Right bracket \]     Circumflex    \^     Underscore    \_
%%   Grave accent  \`     Left brace    \{     Vertical bar  \|
%%   Right brace   \}     Tilde         \~}
\NeedsTeXFormat{pLaTeX2e}
\ProvidesClass{utmcpress}
  [2004/05/01 flatline]
\newif\if@restonecol
\newif\if@titlepage
\newif\if@openright
\newif\if@mainmatter \@mainmattertrue
\newif\if@enablejfam \@enablejfamtrue
\newif\if@konetafoot \@konetafoottrue % 2008-11-27追加 by Orios
\DeclareOption{a4paper}{%
  \setlength\paperheight {297mm}%
  \setlength\paperwidth  {210mm}}
\DeclareOption{a5paper}{%
  \setlength\paperheight {210mm}%
  \setlength\paperwidth  {148mm}}
\DeclareOption{a6paper}{%
  \setlength\paperheight {148mm}%
  \setlength\paperwidth  {105mm}}
\DeclareOption{b4paper}{%
  \setlength\paperheight {364mm}%
  \setlength\paperwidth  {257mm}}
\DeclareOption{b5paper}{%
  \setlength\paperheight {257mm}%
  \setlength\paperwidth  {182mm}}
\DeclareOption{a4j}{%
  \setlength\paperheight {297mm}%
  \setlength\paperwidth  {210mm}}
\DeclareOption{a5j}{%
  \setlength\paperheight {210mm}%
  \setlength\paperwidth  {148mm}}
\DeclareOption{b4j}{%
  \setlength\paperheight {364mm}%
  \setlength\paperwidth  {257mm}}
\DeclareOption{b5j}{%
  \setlength\paperheight {257mm}%
  \setlength\paperwidth  {182mm}}
\DeclareOption{a4var}{%
  \setlength\paperheight {283mm}%
  \setlength\paperwidth  {210mm}}
\DeclareOption{b5var}{%
  \setlength\paperheight {230mm}%
  \setlength\paperwidth  {182mm}}
\DeclareOption{letterpaper}{%
  \setlength\paperheight {11in}%
  \setlength\paperwidth  {8.5in}}
\DeclareOption{legalpaper}{%
  \setlength\paperheight {14in}%
  \setlength\paperwidth  {8.5in}}
\DeclareOption{executivepaper}{%
  \setlength\paperheight {10.5in}%
  \setlength\paperwidth  {7.25in}}
\newcommand{\@ptsize}{0}
\DeclareOption{9pt}{\renewcommand{\@ptsize}{-1}}
\DeclareOption{10pt}{\renewcommand{\@ptsize}{0}}
\DeclareOption{11pt}{\renewcommand{\@ptsize}{1}}
\DeclareOption{12pt}{\renewcommand{\@ptsize}{2}}
\DeclareOption{14pt}{\renewcommand{\@ptsize}{4}}
\DeclareOption{17pt}{\renewcommand{\@ptsize}{7}}
\DeclareOption{20pt}{\renewcommand{\@ptsize}{10}}
\DeclareOption{21pt}{\renewcommand{\@ptsize}{11}}
\DeclareOption{25pt}{\renewcommand{\@ptsize}{15}}
\DeclareOption{30pt}{\renewcommand{\@ptsize}{20}}
\DeclareOption{36pt}{\renewcommand{\@ptsize}{26}}
\DeclareOption{43pt}{\renewcommand{\@ptsize}{33}}
\DeclareOption{12Q}{\renewcommand{\@ptsize}{1200}}
\DeclareOption{14Q}{\renewcommand{\@ptsize}{1400}}
\DeclareOption{landscape}{%
  \setlength\@tempdima   {\paperheight}%
  \setlength\paperheight {\paperwidth}%
  \setlength\paperwidth  {\@tempdima}}
\hour\time \divide\hour by 60\relax
\@tempcnta\hour \multiply\@tempcnta 60\relax
\minute\time \advance\minute-\@tempcnta
\DeclareOption{tombow}{%
  \tombowtrue \tombowdatetrue
  \setlength{\@tombowwidth}{.1\p@}%
  \@bannertoken{%
     \jobname\space:\space\number\year/\number\month/\number\day
      (\number\hour:\number\minute)}
  \maketombowbox}
\DeclareOption{tombo}{%
  \tombowtrue \tombowdatefalse
  \setlength{\@tombowwidth}{.1\p@}%
  \maketombowbox}
\DeclareOption{mentuke}{%
  \tombowtrue \tombowdatefalse
  \setlength{\@tombowwidth}{\z@}%
  \maketombowbox}
\DeclareOption{oneside}{\@twosidefalse \@mparswitchfalse}
\DeclareOption{twoside}{\@twosidetrue \@mparswitchtrue}
\DeclareOption{vartwoside}{\@twosidetrue \@mparswitchfalse}
\DeclareOption{onecolumn}{\@twocolumnfalse}
\DeclareOption{twocolumn}{\@twocolumntrue}
\DeclareOption{titlepage}{\@titlepagetrue}
\DeclareOption{notitlepage}{\@titlepagefalse}
\DeclareOption{openright}{\@openrighttrue}
\DeclareOption{openany}{\@openrightfalse}
\def\eqnarray{%
   \stepcounter{equation}%
   \def\@currentlabel{\p@equation\theequation}%
   \global\@eqnswtrue
   \m@th
   \global\@eqcnt\z@
   \tabskip\@centering
   \let\\\@eqncr
   $$\everycr{}\halign to\displaywidth\bgroup
       \hskip\@centering$\displaystyle\tabskip\z@skip{##}$\@eqnsel
      &\global\@eqcnt\@ne \hfil$\displaystyle{{}##{}}$\hfil
      &\global\@eqcnt\tw@ $\displaystyle{##}$\hfil\tabskip\@centering
      &\global\@eqcnt\thr@@ \hb@xt@\z@\bgroup\hss##\egroup
         \tabskip\z@skip
      \cr}
\DeclareOption{leqno}{\input{leqno.clo}}
\DeclareOption{fleqn}{\input{fleqn.clo}%
  \def\eqnarray{%
    \stepcounter{equation}%
    \def\@currentlabel{\p@equation\theequation}%
    \global\@eqnswtrue\m@th
    \global\@eqcnt\z@
    \tabskip\mathindent
    \let\\=\@eqncr
    \setlength\abovedisplayskip{\topsep}%
    \ifvmode
      \addtolength\abovedisplayskip{\partopsep}%
    \fi
    \addtolength\abovedisplayskip{\parskip}%
    \setlength\belowdisplayskip{\abovedisplayskip}%
    \setlength\belowdisplayshortskip{\abovedisplayskip}%
    \setlength\abovedisplayshortskip{\abovedisplayskip}%
    $$\everycr{}\halign to\linewidth% $$
    \bgroup
      \hskip\@centering$\displaystyle\tabskip\z@skip{##}$\@eqnsel
      &\global\@eqcnt\@ne \hfil$\displaystyle{{}##{}}$\hfil
      &\global\@eqcnt\tw@
        $\displaystyle{##}$\hfil \tabskip\@centering
      &\global\@eqcnt\thr@@ \hb@xt@\z@\bgroup\hss##\egroup
    \tabskip\z@skip\cr
    }}
\DeclareOption{disablejfam}{\@enablejfamfalse}
\newif\ifdraft
\DeclareOption{draft}{\drafttrue \setlength\overfullrule{5pt}}
\DeclareOption{final}{\draftfalse \setlength\overfullrule{0pt}}
\newif\ifjisfont
\jisfonttrue
\DeclareOption{mingoth}{\jisfontfalse}
\newif\ifwinjis
\winjisfalse
\DeclareOption{winjis}{\winjistrue}
\newif\ifpapersize
\papersizefalse
\DeclareOption{papersize}{\papersizetrue}
\newif\if@english
\@englishfalse
\DeclareOption{english}{\@englishtrue}
\newif\if@nidantoc
\DeclareOption{nidantoc}{\@nidantoctrue} % *UTMC*
\DeclareOption{ichidantoc}{\@nidantocfalse} % *UTMC*
\ExecuteOptions{a4paper,twoside,onecolumn,titlepage,openright,final,nidantoc}
\ProcessOptions
%% <jspf>\RequirePackage{url}
\ifpapersize
  \setlength{\@tempdima}{\paperwidth}
  \setlength{\@tempdimb}{\paperheight}
  \iftombow
    \advance \@tempdima 2in
    \advance \@tempdimb 2in
  \fi
  \AtBeginDvi{\special{papersize=\the\@tempdima,\the\@tempdimb}}
\fi
\def\n@baseline{16}
\ifnum\@ptsize=-1
  \mag 913 % formerly 900
  \setlength\paperwidth{1.09529\paperwidth}%
  \setlength\paperheight{1.09529\paperheight}%
  \def\n@baseline{15}%
\fi
\ifnum\@ptsize=1
  \mag 1095 % formerly 1100
  \setlength\paperwidth{0.913242\paperwidth}% formerly 0.90909
  \setlength\paperheight{0.913242\paperheight}% 0.90909
\fi
\ifnum\@ptsize=2
  \mag 1200
  \setlength\paperwidth{0.833333\paperwidth}%
  \setlength\paperheight{0.833333\paperheight}%
\fi
\ifnum\@ptsize=4
  \mag 1440
  \setlength\paperwidth{0.694444\paperwidth}%
  \setlength\paperheight{0.694444\paperheight}%
\fi
\ifnum\@ptsize=7
  \mag 1728
  \setlength\paperwidth{0.578704\paperwidth}%
  \setlength\paperheight{0.578704\paperheight}%
\fi
\ifnum\@ptsize=10
  \mag 2000
  \setlength\paperwidth{0.5\paperwidth}%
  \setlength\paperheight{0.5\paperheight}%
\fi
\ifnum\@ptsize=11
  \mag 2074
  \setlength\paperwidth{0.48216\paperwidth}%
  \setlength\paperheight{0.48216\paperheight}%
\fi
\ifnum\@ptsize=15
  \mag 2488
  \setlength\paperwidth{0.401929\paperwidth}%
  \setlength\paperheight{0.401929\paperheight}%
\fi
\ifnum\@ptsize=20
  \mag 2986
  \setlength\paperwidth{0.334896\paperwidth}%
  \setlength\paperheight{0.334896\paperheight}%
\fi
\ifnum\@ptsize=26
  \mag 3583
  \setlength\paperwidth{0.279096\paperwidth}%
  \setlength\paperheight{0.279096\paperheight}%
\fi
\ifnum\@ptsize=33
  \mag 4300
  \setlength\paperwidth{0.232558\paperwidth}%
  \setlength\paperheight{0.232558\paperheight}%
\fi
\ifnum\@ptsize=1200
  \mag 923
  \setlength\paperwidth{1.0834236\paperwidth}%
  \setlength\paperheight{1.0834236\paperheight}%
\fi
\ifnum\@ptsize=1400
  \mag 1077
  \setlength\paperwidth{0.928505\paperwidth}%
  \setlength\paperheight{0.928505\paperheight}%
\fi
\ifpapersize
  \setlength{\@tempdima}{\paperwidth}
  \setlength{\@tempdimb}{\paperheight}
  \iftombow
    \advance \@tempdima 2truein
    \advance \@tempdimb 2truein
  \fi
  \AtBeginDvi{\special{pdf: pagesize width \the\@tempdima\space height \the\@tempdimb}}
\fi
\ifwinjis
  \DeclareFontShape{JY1}{mc}{m}{n}{<-> s * [0.961] winjis}{}
  \DeclareFontShape{JY1}{gt}{m}{n}{<-> s * [0.961] winjisg}{}
  \DeclareFontShape{JT1}{mc}{m}{n}{<-> s * [0.961] winjis-v}{}
  \DeclareFontShape{JT1}{gt}{m}{n}{<-> s * [0.961] winjisg-v}{}
\else
  \ifjisfont
    \DeclareFontShape{JY1}{mc}{m}{n}{<-> s * [0.961] jis}{}
    \DeclareFontShape{JY1}{gt}{m}{n}{<-> s * [0.961] jisg}{}
  \else
    \DeclareFontShape{JY1}{mc}{m}{n}{<-> s * [0.961] min10}{}
    \DeclareFontShape{JY1}{gt}{m}{n}{<-> s * [0.961] goth10}{}
  \fi
  \DeclareFontShape{JT1}{mc}{m}{n}{<-> s * [0.961] tmin10}{}
  \DeclareFontShape{JT1}{gt}{m}{n}{<-> s * [0.961] tgoth10}{}
\fi
\DeclareFontShape{JY1}{mc}{m}{it}{<->ssub*mc/m/n}{}
\DeclareFontShape{JY1}{mc}{m}{sl}{<->ssub*mc/m/n}{}
\DeclareFontShape{JY1}{mc}{m}{sc}{<->ssub*mc/m/n}{}
\DeclareFontShape{JY1}{gt}{m}{it}{<->ssub*gt/m/n}{}
\DeclareFontShape{JY1}{gt}{m}{sl}{<->ssub*gt/m/n}{}
\DeclareFontShape{JY1}{mc}{bx}{it}{<->ssub*gt/m/n}{}
\DeclareFontShape{JY1}{mc}{bx}{sl}{<->ssub*gt/m/n}{}
\DeclareFontShape{JT1}{mc}{m}{it}{<->ssub*mc/m/n}{}
\DeclareFontShape{JT1}{mc}{m}{sl}{<->ssub*mc/m/n}{}
\DeclareFontShape{JT1}{mc}{m}{sc}{<->ssub*mc/m/n}{}
\DeclareFontShape{JT1}{gt}{m}{it}{<->ssub*gt/m/n}{}
\DeclareFontShape{JT1}{gt}{m}{sl}{<->ssub*gt/m/n}{}
\DeclareFontShape{JT1}{mc}{bx}{it}{<->ssub*gt/m/n}{}
\DeclareFontShape{JT1}{mc}{bx}{sl}{<->ssub*gt/m/n}{}
\DeclareRobustCommand\sffamily
        {\not@math@alphabet\sffamily\mathsf
         \romanfamily\sfdefault\kanjifamily\gtdefault\selectfont}
\DeclareRobustCommand\ttfamily
        {\not@math@alphabet\ttfamily\mathtt
         \romanfamily\ttdefault\kanjifamily\gtdefault\selectfont}
\def\textmc#1{\relax\ifmmode\hbox\fi{\mcfamily #1}}
\def\textgt#1{\relax\ifmmode\hbox\fi{\gtfamily #1}}
\if@enablejfam
  \DeclareSymbolFont{mincho}{JY1}{mc}{m}{n}
  \DeclareSymbolFontAlphabet{\mathmc}{mincho}
  \SetSymbolFont{mincho}{bold}{JY1}{gt}{m}{n}
  \DeclareMathAlphabet{\mathgt}{JY1}{gt}{m}{n}
  \reDeclareMathAlphabet{\mathrm}{\@mathrm}{\@mathmc}
  \reDeclareMathAlphabet{\mathbf}{\@mathbf}{\@mathgt}
  \jfam\symmincho
\fi
\prebreakpenalty\jis"2147=10000      % 5000   ’
\postbreakpenalty\jis"2148=10000     % 5000   “
\prebreakpenalty\jis"2149=10000      % 5000   ”
\inhibitxspcode`〒=2
\xspcode`+=3
\xspcode`\%=3
\def\@{\spacefactor3000\space}
\def\@setfontsize#1#2#3{%
  \ifx\protect\@typeset@protect
    \let\@currsize#1%
  \fi
  \fontsize{#2}{#3}\selectfont
  \ifdim\parindent>\z@
    \parindent=1zw
  \fi
  \kanjiskip=0zw plus .1zw minus .01zw
  \ifdim\xkanjiskip>\z@
    \xkanjiskip=0.25em plus 0.15em minus 0.06em
  \fi}
\emergencystretch 3zw
\newif\ifnarrowbaselines
\if@english\narrowbaselinestrue\fi
\def\narrowbaselines{%
  \narrowbaselinestrue
  \skip0=\abovedisplayskip
  \skip2=\abovedisplayshortskip
  \skip4=\belowdisplayskip
  \skip6=\belowdisplayshortskip
  \@currsize\selectfont
  \abovedisplayskip=\skip0
  \abovedisplayshortskip=\skip2
  \belowdisplayskip=\skip4
  \belowdisplayshortskip=\skip6\relax}
\def\widebaselines{\narrowbaselinesfalse\@currsize\selectfont}
\renewcommand{\normalsize}{%
  \ifnarrowbaselines
    \@setfontsize\normalsize\@xpt\@xiipt
  \else
    \@setfontsize\normalsize\@xpt{\n@baseline}%
  \fi
  \abovedisplayskip 10\p@ \@plus3\p@ \@minus4\p@
  \abovedisplayshortskip \z@ \@plus3\p@
  \belowdisplayskip \abovedisplayskip
  \belowdisplayshortskip \belowdisplayskip
  \let\@listi\@listI}
\normalsize
\setbox0\hbox{\char\euc"A1A1}%
\setlength\Cht{\ht0}
\setlength\Cdp{\dp0}
\setlength\Cwd{\wd0}
\setlength\Cvs{\baselineskip}
\setlength\Chs{\wd0}
\newcommand{\small}{%
  \ifnarrowbaselines
    \@setfontsize\small\@ixpt{11}%
  \else
    \@setfontsize\small\@ixpt{13}%
  \fi
  \abovedisplayskip 9\p@ \@plus3\p@ \@minus4\p@
  \abovedisplayshortskip  \z@ \@plus3\p@
  \belowdisplayskip \abovedisplayskip
  \belowdisplayshortskip \belowdisplayskip
  \def\@listi{\leftmargin\leftmargini
              \topsep \z@
              \parsep \z@
              \itemsep \parsep}}
\newcommand{\footnotesize}{%
  \ifnarrowbaselines
    \@setfontsize\footnotesize\@viiipt{9.5}%
  \else
    \@setfontsize\footnotesize\@viiipt{11}%
  \fi
  \abovedisplayskip 6\p@ \@plus2\p@ \@minus3\p@
  \abovedisplayshortskip  \z@ \@plus2\p@
  \belowdisplayskip \abovedisplayskip
  \belowdisplayshortskip \belowdisplayskip
  \def\@listi{\leftmargin\leftmargini
              \topsep \z@
              \parsep \z@
              \itemsep \parsep}}
\newcommand{\scriptsize}{\@setfontsize\scriptsize\@viipt\@viiipt}
\newcommand{\tiny}{\@setfontsize\tiny\@vpt\@vipt}
\if@twocolumn
  \newcommand{\large}{\@setfontsize\large\@xiipt{\n@baseline}}
\else
  \newcommand{\large}{\@setfontsize\large\@xiipt{17}}
\fi
\newcommand{\Large}{\@setfontsize\Large\@xivpt{21}}
\newcommand{\LARGE}{\@setfontsize\LARGE\@xviipt{25}}
\newcommand{\huge}{\@setfontsize\huge\@xxpt{28}}
\newcommand{\Huge}{\@setfontsize\Huge\@xxvpt{33}}
\everydisplay=\expandafter{\the\everydisplay \narrowbaselines}
\newcommand{\headfont}{\gtfamily\sffamily\bfseries} % *UTMC* 2008-03-13 by Orios
%\newcommand{\headfont}{\gtfamily\sffamily}
\setlength\columnsep{2zw}
\setlength\columnseprule{0\p@}
\setlength\lineskip{1\p@}
\setlength\normallineskip{1\p@}
\setlength\lineskiplimit{1\p@}
\setlength\normallineskiplimit{1\p@}
\renewcommand{\baselinestretch}{}
\setlength\parskip{0\p@}
\setlength\parindent{1zw}
\@lowpenalty   51
\@medpenalty  151
\@highpenalty 301
\setlength\topskip{5\p@}
\setlength\headheight{2\topskip}
%\setlength\footskip{0pt}
\if@konetafoot \setlength\footskip{24pt}\else\setlength\footskip{0pt}\fi % 2008-11-27追加 by Orios
\setlength\headsep{6mm}
\setlength\maxdepth{.5\topskip}

% 傍注も含めた幅
\newdimen\fullwidth
\setlength\fullwidth{\paperwidth}
\addtolength\fullwidth{-30mm}

% \fullwidth を 1zw または 2zw の倍数にする
\if@twocolumn \@tempdima=2zw \else \@tempdima=1zw \fi
\divide\fullwidth\@tempdima \multiply\fullwidth\@tempdima

% 本文の幅
\setlength\textwidth{\fullwidth}

% 1行が40文字を超えない仕組みだが、よけいなお世話。
%\if@twocolumn \else
%  \ifdim \fullwidth>40zw
%    \setlength\textwidth{40zw}
%  \fi
%\fi

% 本文の高さ
\setlength{\textheight}{0.9\paperheight}
\addtolength{\textheight}{-\topskip}
\addtolength{\textheight}{-\headsep}
% \addtolength{\textheight}{-\footskip}
\addtolength{\textheight}{-0pt} % 2008-11-27追加 by Orios

% \textheight が \baselineskip の倍数になるようにする
\addtolength{\textheight}{-\topskip}
\divide\textheight\baselineskip
\multiply\textheight\baselineskip
\addtolength{\textheight}{\topskip}

\addtolength{\textheight}{0.1\p@}
\setlength\marginparsep{\columnsep}
\setlength\marginparpush{\baselineskip}
\setlength{\oddsidemargin}{\paperwidth}
\addtolength{\oddsidemargin}{-\fullwidth}
\setlength{\oddsidemargin}{.5\oddsidemargin}
\iftombow
  \addtolength{\oddsidemargin}{-1in}
\else
  \addtolength{\oddsidemargin}{-1truein}
\fi
\setlength{\evensidemargin}{\oddsidemargin}
\if@mparswitch
  \addtolength{\evensidemargin}{\fullwidth}
  \addtolength{\evensidemargin}{-\textwidth}
\fi
\setlength\marginparwidth{\paperwidth}
\addtolength\marginparwidth{-\oddsidemargin}
\addtolength\marginparwidth{-1truein}
\addtolength\marginparwidth{-\textwidth}
\addtolength\marginparwidth{-1cm}
\addtolength\marginparwidth{-\marginparsep}
\@tempdima=1zw
\divide\marginparwidth\@tempdima
\multiply\marginparwidth\@tempdima
\setlength\topmargin{\paperheight}
\addtolength\topmargin{-\textheight}
\addtolength\topmargin{-\topskip}
\addtolength\topmargin{-2\headsep}
%\addtolength\topmargin{-\footskip}
\addtolength\topmargin{-0pt} % 2008-11-27追加 by Orios
\setlength\topmargin{0.5\topmargin}
\iftombow
  \addtolength\topmargin{-1in}
\else
  \addtolength\topmargin{-1truein}
\fi
{\footnotesize\global\setlength\footnotesep{\baselineskip}}
\setlength\footnotesep{0.7\footnotesep}
\setlength{\skip\footins}{16\p@ \@plus 5\p@ \@minus 2\p@}
\setcounter{topnumber}{9}
\renewcommand{\topfraction}{.85}
\setcounter{bottomnumber}{9}
\renewcommand{\bottomfraction}{.8}
\setcounter{totalnumber}{20}
\renewcommand{\textfraction}{.1}
\renewcommand{\floatpagefraction}{.8}
\setcounter{dbltopnumber}{9}
\renewcommand{\dbltopfraction}{.8}
\renewcommand{\dblfloatpagefraction}{.8}
\setlength\floatsep    {12\p@ \@plus 2\p@ \@minus 2\p@}
\setlength\textfloatsep{20\p@ \@plus 2\p@ \@minus 4\p@}
\setlength\intextsep   {12\p@ \@plus 2\p@ \@minus 2\p@}
\setlength\dblfloatsep    {12\p@ \@plus 2\p@ \@minus 2\p@}
\setlength\dbltextfloatsep{20\p@ \@plus 2\p@ \@minus 4\p@}
\setlength\@fptop{0\p@ \@plus 1fil}
\setlength\@fpsep{8\p@ \@plus 2fil}
\setlength\@fpbot{0\p@ \@plus 1fil}
\setlength\@dblfptop{0\p@ \@plus 1fil}
\setlength\@dblfpsep{8\p@ \@plus 2fil}
\setlength\@dblfpbot{0\p@ \@plus 1fil}

\newcounter{konetafoot}
\setcounter{konetafoot}{0}
\def\konetafoot#1{\addtocounter{konetafoot}{1}\expandafter\def\csname konetafootc@\roman{konetafoot}\endcsname{#1}}

\def\ps@plainfoot{%
  \let\@mkboth\@gobbletwo
  \let\@oddhead\@empty
  \def\@oddfoot{\normalfont\hfil\thepage\hfil}%
  \let\@evenhead\@empty
  \let\@evenfoot\@oddfoot}
\def\ps@plainhead{%
  \let\@mkboth\@gobbletwo
%  \let\@oddfoot\@empty
%  \let\@evenfoot\@empty
  % 小ネタ用フッタ 2008-11-27追加 by Orios
  \if@mainmatter
    \if@konetafoot \def\@oddfoot{\csname konetafootc@\roman{page}\endcsname\hfil} \else \let\@oddfoot\@empty \fi
    \let\@evenfoot\@oddfoot
  \else \let\@oddfoot\@empty\let\@evenfoot\@empty\fi
  \def\@evenhead{%
    \if@mparswitch \hss \fi
    \hbox to \fullwidth{\textbf{\thepage}\hfil}%
    \if@mparswitch\else \hss \fi}%
  \def\@oddhead{%
    \hbox to \fullwidth{\hfil\textbf{\thepage}}\hss}}
\let\ps@plain\ps@plainhead

\def\ps@headings{%
%  \let\@oddfoot\@empty
%  \let\@evenfoot\@empty
  % 小ネタ用フッタ 2008-11-27追加 by Orios
  \if@konetafoot \def\@oddfoot{\csname konetafootc@\roman{page}\endcsname\hfil} \else \let\@oddfoot\@empty \fi % 2008-11-27追加 by Orios
  \let\@evenfoot\@oddfoot
  \def\@evenhead{%
    \if@mparswitch \hss \fi
    \underline{\hbox to \fullwidth{\autoxspacing
        \textbf{\thepage}\hfil\leftmark}}%
    \if@mparswitch\else \hss \fi}%
  \def\@oddhead{\underline{\hbox to \fullwidth{\autoxspacing
        {\if@twoside\rightmark\else\leftmark\fi}\hfil\textbf{\thepage}}}\hss}%
  \let\@mkboth\markboth
  \def\chaptermark##1{\markboth{% *UTMC*
    UTMC Press \number\year--\number\month
    }{}
    \markright{%
    ##1}{}}%
%  \def\chaptermark##1{\markboth{%
%    \ifnum \c@secnumdepth >\m@ne
%      \if@mainmatter
%        \@chapapp\thechapter\@chappos\hskip1zw
%      \fi
%    \fi
%    ##1}{}}%
  \def\sectionmark##1{}
%  \def\sectionmark##1{\markright{%
%    \ifnum \c@secnumdepth >\z@ \thesection \hskip1zw\fi
%    ##1}}}%
}
\def\ps@myheadings{%
  \let\@oddfoot\@empty\let\@evenfoot\@empty
  \def\@evenhead{%
    \if@mparswitch \hss \fi%
    \hbox to \fullwidth{\thepage\hfil\leftmark}%
    \if@mparswitch\else \hss \fi}%
  \def\@oddhead{%
    \hbox to \fullwidth{\rightmark\hfil\thepage}\hss}%
  \let\@mkboth\@gobbletwo
  \let\chaptermark\@gobble
  \let\sectionmark\@gobble
}
\def\plainifnotempty{%
  \ifx \@oddhead \@empty
    \ifx \@oddfoot \@empty
    \else
      \thispagestyle{plainfoot}%
    \fi
  \else
    \thispagestyle{plainhead}%
  \fi}
\if@titlepage
  \newcommand{\maketitle}{%
    \begin{titlepage}%
      \let\footnotesize\small
      \let\footnoterule\relax
      \let\footnote\thanks
      \null\vfil
      \vskip 60\p@
      \begin{center}%
        {\LARGE \@title \par}%
        \vskip 3em%
        {\large
          \lineskip .75em
          \begin{tabular}[t]{c}%
            \@author
          \end{tabular}\par}%
        \vskip 1.5em
        {\large \@date \par}%
      \end{center}\par
      \@thanks\vfil\null
    \end{titlepage}%
    \setcounter{footnote}{0}%
    \global\let\thanks\relax
    \global\let\maketitle\relax
    \global\let\@thanks\@empty
    \global\let\@author\@empty
    \global\let\@date\@empty
    \global\let\@title\@empty
    \global\let\title\relax
    \global\let\author\relax
    \global\let\date\relax
    \global\let\and\relax
  }%
\else
  \newcommand{\maketitle}{\par
    \begingroup
      \renewcommand\thefootnote{\@fnsymbol\c@footnote}%
      \def\@makefnmark{\rlap{\@textsuperscript{\normalfont\@thefnmark}}}%
      \long\def\@makefntext##1{\advance\leftskip 3zw
        \parindent 1zw\noindent
        \llap{\@textsuperscript{\normalfont\@thefnmark}\hskip0.3zw}##1}%
      \if@twocolumn
        \ifnum \col@number=\@ne
          \@maketitle
        \else
          \twocolumn[\@maketitle]%
        \fi
      \else
        \newpage
        \global\@topnum\z@  % Prevents figures from going at top of page.
        \@maketitle
      \fi
      \plainifnotempty
      \@thanks
    \endgroup
    \setcounter{footnote}{0}%
    \global\let\thanks\relax
    \global\let\maketitle\relax
    \global\let\@thanks\@empty
    \global\let\@author\@empty
    \global\let\@date\@empty
    \global\let\@title\@empty
    \global\let\title\relax
    \global\let\author\relax
    \global\let\date\relax
    \global\let\and\relax
  }
  \def\@maketitle{%
    \newpage\null
    \vskip 2em
    \begin{center}%
      \let\footnote\thanks
      {\LARGE \@title \par}%
      \vskip 1.5em
      {\large
        \lineskip .5em
        \begin{tabular}[t]{c}%
          \@author
        \end{tabular}\par}%
      \vskip 1em
      {\large \@date}%
    \end{center}%
    \par\vskip 1.5em
  }
\fi
\def\@startsection#1#2#3#4#5#6{%
  \if@noskipsec \leavevmode \fi
  \par
  \@tempskipa #4\relax
  \@afterindenttrue
  \ifdim \@tempskipa <\z@
    \@tempskipa -\@tempskipa \@afterindentfalse
  \fi
  \if@nobreak
    \everypar{}%
  \else
    \addpenalty\@secpenalty
    \ifdim \@tempskipa >\z@
      \null
      \vspace*{-\baselineskip}\vskip\@tempskipa
    \fi
  \fi
  \noindent
  \@ifstar
    {\@ssect{#3}{#4}{#5}{#6}}%
    {\@dblarg{\@sect{#1}{#2}{#3}{#4}{#5}{#6}}}}
% 節番号の後のアキを調整 by Orios [2008-03-10]
\def\@seccnt@afterskip@section{.\hskip.5zw}
\def\@seccnt@afterskip@subsection{\quad}
\def\@seccnt@afterskip@subsubsection{\quad}
\def\@seccnt@afterskip@paragraph{\quad}
\def\@seccnt@afterskip@subparagraph{\quad}
\def\@seccntformat#1{\csname the#1\endcsname\csname @seccnt@afterskip@#1\endcsname}
% 目次の表記を設定 by Orios [2008-03-22]
\def\@toc@number@section{\thesection.}
\def\@toc@number@subsection{\thesubsection}
\def\@toc@number@subsubsection{\thesubsubsection}
\def\@toc@number@paragraph{\theparagraph}
\def\@toc@number@subparagraph{\thesubparagraph}
\def\@sect#1#2#3#4#5#6[#7]#8{%
  \ifnum #2>\c@secnumdepth
    \let\@svsec\@empty
  \else
    \refstepcounter{#1}%
    \protected@edef\@svsec{\@seccntformat{#1}\relax}%
  \fi
  \@tempskipa #5\relax
  \ifdim \@tempskipa<\z@
    \def\@svsechd{%
      #6{\hskip #3\relax
      \@svsec #8}%
      \csname #1mark\endcsname{#7}%
      \addcontentsline{toc}{#1}{%
        \ifnum #2>\c@secnumdepth \else
          \protect\numberline{\csname @toc@number@#1\endcsname}% *UTMC* Was: \protect\numberline{\csname the#1\endcsname}%
        \fi
        #7}}% 目次にフルネームを載せるなら #8
  \else
    \begingroup
      \interlinepenalty \@M % 下から移動
      #6{%
        \@hangfrom{\hskip #3\relax\@svsec}%
        #8\@@par}%
    \endgroup
    \csname #1mark\endcsname{#7}%
    \addcontentsline{toc}{#1}{%
      \ifnum #2>\c@secnumdepth \else
        \protect\numberline{\csname @toc@number@#1\endcsname}% *UTMC* Was: \protect\numberline{\csname the#1\endcsname}%
      \fi
      #7}% 目次にフルネームを載せるならここは #8
  \fi
  \@xsect{#5}}
\def\@xsect#1{%
  \@tempskipa #1\relax
  \ifdim \@tempskipa<\z@
    \@nobreakfalse
    \global\@noskipsectrue
    \everypar{%
      \if@noskipsec
        \global\@noskipsecfalse
       {\setbox\z@\lastbox}%
        \clubpenalty\@M
        \begingroup \@svsechd \endgroup
        \unskip
        \@tempskipa #1\relax
        \hskip -\@tempskipa
      \else
        \clubpenalty \@clubpenalty
        \everypar{\everyparhook}%
      \fi\everyparhook}%
  \else
    \par \nobreak
    \vskip \@tempskipa
    \@afterheading
  \fi
  \par  % 2000-12-18
  \ignorespaces}
\def\@ssect#1#2#3#4#5{%
  \@tempskipa #3\relax
  \ifdim \@tempskipa<\z@
    \def\@svsechd{#4{\hskip #1\relax #5}}%
  \else
    \begingroup
      #4{%
        \@hangfrom{\hskip #1}%
          \interlinepenalty \@M #5\@@par}%
    \endgroup
  \fi
  \@xsect{#3}}
\newcommand*\chaptermark[1]{}
%\setcounter{secnumdepth}{2}
\setcounter{secnumdepth}{3} % *UTMC* by Orios [2008-06-08]

% *UTMC* 書籍情報の設定 by Orios [2008-03-14]
% Usage: \volumeinfo{年}{月}{日}{分冊番号}{エイリアス}
\newcounter{volume}
\newcommand{\volumeinfo}[5]{%
  \def\issueyear{#1}%
  \def\issuemonth{#2}%
  \ifnum#2<10
    \def\twodigitissuemonth{0#2}%
  \else
    \def\twodigitissuemonth{#2}%
  \fi%
  \def\issueday{#3}
  \setcounter{volume}{#4}%
  \ifnum#4<10
    \def\twodigitvolume{0#4}%
  \else
    \def\twodigitvolume{#4}%
  \fi
  \def\issuealias{#5}}
% *UTMC* 印刷年月日 by Orios [2008-03-14]
% Usage: \printdate{年}{月}{日}
\newcommand{\printdate}[3]{%
  \def\printyear{#1}
  \def\printmonth{#2}
  \def\printday{#3}}
% *UTMC* 編集者情報等の設定 by Orios [2008-12-11]
\newcommand{\editors}[2]{%
  \def\editor{#1}
  \def\coverauthor{#2}}
% *UTMC* 同月号が複数出る時のための指定
% Usage: \setcounter{volume}{分冊番号}
%\setcounter{volume}{1}

\newcounter{part}
\newcounter{chapter}
\newcounter{section}[chapter]
\newcounter{subsection}[section]
\newcounter{subsubsection}[subsection]
\newcounter{paragraph}[subsubsection]
\newcounter{subparagraph}[paragraph]
\renewcommand{\thepart}{\@Roman\c@part}
\renewcommand{\thechapter}{\@arabic\c@chapter}
\renewcommand{\thesection}{\@arabic\c@section} % *UTMC*
%\renewcommand{\thesection}{\thechapter.\@arabic\c@section}
\renewcommand{\thesubsection}{\thesection.\@arabic\c@subsection}
\renewcommand{\thesubsubsection}{%
   \thesubsection.\@arabic\c@subsubsection}
\renewcommand{\theparagraph}{%
   \thesubsubsection.\@arabic\c@paragraph}
\renewcommand{\thesubparagraph}{%
   \theparagraph.\@arabic\c@subparagraph}
\newcommand{\@chapapp}{\prechaptername}
\newcommand{\@chappos}{\postchaptername}
% *UTMC* 本文以前のページ数を把握するためのカウンタ by Orios [2008-03-22]
\newcount\c@prepage
\c@prepage=0
\newcommand\frontmatter{%
  \if@openright
    \cleardoublepage
  \else
    \clearpage
  \fi
  \@mainmatterfalse
  \advance \c@prepage by \the\c@page% *UTMC*
  \advance \c@prepage by -1% *UTMC*
  \pagenumbering{roman}}
\newcommand\mainmatter{%
    \cleardoublepage
  \@mainmattertrue
  \advance \c@prepage by \the\c@page% *UTMC*
  \advance \c@prepage by -1% *UTMC*
  \pagenumbering{arabic}}
\newcommand\backmatter{%
  \if@openright
    \cleardoublepage
  \else
    \clearpage
  \fi
  \@mainmatterfalse}
\newcommand\part{%
  \if@openright
    \cleardoublepage
  \else
    \clearpage
  \fi
  \thispagestyle{empty}% 欧文用標準スタイルでは plain
  \if@twocolumn
    \onecolumn
    \@restonecoltrue
  \else
    \@restonecolfalse
  \fi
  \null\vfil
  \secdef\@part\@spart}
\def\@part[#1]#2{%
  \ifnum \c@secnumdepth >-2\relax
    \refstepcounter{part}%
    \addcontentsline{toc}{part}{%
      \prepartname\thepart\postpartname\hspace{1zw}#1}%
  \else
    \addcontentsline{toc}{part}{#1}%
  \fi
  \markboth{}{}%
  {\centering
    \interlinepenalty \@M
    \normalfont
    \ifnum \c@secnumdepth >-2\relax
      \huge\headfont \prepartname\thepart\postpartname
      \par\vskip20\p@
    \fi
    \Huge \headfont #2\par}%
  \@endpart}
\def\@spart#1{{%
    \centering
    \interlinepenalty \@M
    \normalfont
    \Huge \headfont #1\par}%
  \@endpart}
\def\@endpart{\vfil\newpage
  \if@twoside
    \null
    \thispagestyle{empty}%
    \newpage
  \fi
  \if@restonecol
    \twocolumn
  \fi}
\newcommand{\chapter}{%
  \clearpage % *UTMC* Was: \if@openright\cleardoublepage\else\clearpage\fi
  \plainifnotempty % 元: \thispagestyle{plain}
  \global\@topnum\z@
  \secdef\@chapter\@schapter}
\def\@chapter[#1]#2{%
  \ifnum \c@secnumdepth >\m@ne
    \if@mainmatter
      \refstepcounter{chapter}%
      \typeout{\@chapapp\thechapter\@chappos}%
      \addcontentsline{toc}{chapter}%
        {\protect\numberline{\@chapapp\thechapter\@chappos}#1}%
    \else\addcontentsline{toc}{chapter}{#1}\fi
  \else
    \addcontentsline{toc}{chapter}{#1}%
  \fi
  \chaptermark{#1}%
  \addtocontents{lof}{\protect\addvspace{10\p@}}%
  \addtocontents{lot}{\protect\addvspace{10\p@}}%
  \if@twocolumn
    \@topnewpage[\@makechapterhead{#2}]%
  \else
    \@makechapterhead{#2}%
    \@afterheading
  \fi}
\def\@makechapterhead#1{%
  \vspace*{2\Cvs}% 欧文は50pt
  {\parindent \z@ \raggedright \normalfont
    \ifnum \c@secnumdepth >\m@ne
      \if@mainmatter
        \huge\headfont \@chapapp\thechapter\@chappos
        \par\nobreak
        \vskip \Cvs % 欧文は20pt
      \fi
    \fi
    \interlinepenalty\@M
    \Huge \headfont #1\par\nobreak
    \vskip 3\Cvs}} % 欧文は40pt
\def\@schapter#1{%
  \chaptermark{#1}%
  \if@twocolumn
    \@topnewpage[\@makeschapterhead{#1}]%
  \else
    \@makeschapterhead{#1}\@afterheading
  \fi}
\def\@makeschapterhead#1{%
  \vspace*{\Cvs} % *UTMC* Was: \vspace*{2\Cvs}% 欧文は50pt
  {\parindent \z@ \raggedright
    \normalfont
    \interlinepenalty\@M
    \Huge \headfont #1\par\nobreak
    \vskip 3\Cvs}} % 欧文は40pt
\if@twocolumn
  \newcommand{\section}{%
    \@startsection{section}{1}{\z@}%
    {0.6\Cvs}{0.4\Cvs}%
    {\normalfont\large\headfont\raggedright}}
\else
  \newcommand{\section}{\@startsection{section}{1}{\z@}%
    {\Cvs \@plus.5\Cdp \@minus.2\Cdp}% 前アキ
    {.5\Cvs \@plus.3\Cdp}% 後アキ
    {\normalfont\LARGE\headfont\raggedright}} % *UTMC*
    %{\normalfont\Large\headfont\raggedright}}
\fi
\if@twocolumn
  \newcommand{\subsection}{\@startsection{subsection}{2}{\z@}%
    {\z@}{\z@}%
    {\normalfont\normalsize\headfont}}
\else
  \newcommand{\subsection}{\@startsection{subsection}{2}{\z@}%
    {\Cvs \@plus.5\Cdp \@minus.2\Cdp}% 前アキ
    {.5\Cvs \@plus.3\Cdp}% 後アキ
    {\normalfont\large\headfont}}
\fi
\if@twocolumn
  \newcommand{\subsubsection}{\@startsection{subsubsection}{3}{\z@}%
    {\z@}{\z@}%
    {\normalfont\normalsize\headfont}}
\else
  \newcommand{\subsubsection}{\@startsection{subsubsection}{3}{\z@}%
    {\Cvs \@plus.5\Cdp \@minus.2\Cdp}%
    {\z@}%
    {\normalfont\normalsize\headfont}}
\fi
\if@twocolumn
  \newcommand{\paragraph}{\@startsection{paragraph}{4}{\z@}%
    {\z@}{-1zw}% 改行せず 1zw のアキ
    {\normalfont\normalsize\headfont ■}}
\else
  \newcommand{\paragraph}{\@startsection{paragraph}{4}{\z@}%
    {0.5\Cvs \@plus.5\Cdp \@minus.2\Cdp}%
    {-1zw}% 改行せず 1zw のアキ
    {\normalfont\normalsize\headfont ■}}
\fi
\newcommand{\subparagraph}{\@startsection{subparagraph}{5}{\z@}%
   {\z@}{-1zw}%
   {\normalfont\normalsize\headfont}}
\setlength\leftmargini{3zw}
\if@twocolumn
  \setlength\leftmarginii {2zw} % 2.2em
  \setlength\leftmarginiii{2zw} % 1.87em
  \setlength\leftmarginiv {2zw} % 1.7em
  \setlength\leftmarginv  {1zw} % .5em
  \setlength\leftmarginvi {1zw} % .5em
\else
  \setlength\leftmarginii {2zw} % 2.2em
  \setlength\leftmarginiii{2zw} % 1.87em
  \setlength\leftmarginiv {2zw} % 1.7em
  \setlength\leftmarginv  {1zw} % 1em
  \setlength\leftmarginvi {1zw} % 1em
\fi
\setlength  \labelsep  {0.5zw} % .5em
\setlength  \labelwidth{\leftmargini}
\addtolength\labelwidth{-\labelsep}
\setlength\partopsep{\z@} % {2\p@ \@plus 1\p@ \@minus 1\p@}
\@beginparpenalty -\@lowpenalty
\@endparpenalty   -\@lowpenalty
\@itempenalty     -\@lowpenalty
\def\@listi{\leftmargin\leftmargini
  \parsep \z@
  \topsep 0.5\baselineskip \@plus 0.2\baselineskip \@minus 0.1\baselineskip
  \itemsep \z@ \relax}
\let\@listI\@listi
\@listi
\def\@listii{\leftmargin\leftmarginii
  \labelwidth\leftmarginii \advance\labelwidth-\labelsep
  \topsep \z@
  \parsep \z@
  \itemsep\parsep}
\def\@listiii{\leftmargin\leftmarginiii
  \labelwidth\leftmarginiii \advance\labelwidth-\labelsep
  \topsep \z@
  \parsep \z@
  \itemsep\parsep}
\def\@listiv {\leftmargin\leftmarginiv
              \labelwidth\leftmarginiv
              \advance\labelwidth-\labelsep}
\def\@listv  {\leftmargin\leftmarginv
              \labelwidth\leftmarginv
              \advance\labelwidth-\labelsep}
\def\@listvi {\leftmargin\leftmarginvi
              \labelwidth\leftmarginvi
              \advance\labelwidth-\labelsep}
\renewcommand{\theenumi}{\@arabic\c@enumi}
\renewcommand{\theenumii}{\@alph\c@enumii}
\renewcommand{\theenumiii}{\@roman\c@enumiii}
\renewcommand{\theenumiv}{\@Alph\c@enumiv}
\newcommand{\labelenumi}{\theenumi.}
\newcommand{\labelenumii}{\inhibitglue（\theenumii）\inhibitglue}
\newcommand{\labelenumiii}{\theenumiii.}
\newcommand{\labelenumiv}{\theenumiv.}
\renewcommand{\p@enumii}{\theenumi}
\renewcommand{\p@enumiii}{\theenumi\inhibitglue（\theenumii）}
\renewcommand{\p@enumiv}{\p@enumiii\theenumiii}
\newcommand\labelitemi{\textbullet}
\newcommand\labelitemii{\normalfont\bfseries \textendash}
\newcommand\labelitemiii{\textasteriskcentered}
\newcommand\labelitemiv{\textperiodcentered}
\newenvironment{description}{%
  \list{}{%
    \labelwidth=\leftmargin
    \labelsep=1zw
    \advance \labelwidth by -\labelsep
    \let \makelabel=\descriptionlabel}}{\endlist}
\newcommand*\descriptionlabel[1]{\normalfont\headfont #1\hfil}
\newenvironment{abstract}{%
  \begin{list}{}{%
    \listparindent=1zw
    \itemindent=\listparindent
    \rightmargin=0pt
    \leftmargin=5zw}\item[]}{\end{list}\vspace{\baselineskip}}
\newenvironment{verse}{%
  \let \\=\@centercr
  \list{}{%
    \itemsep \z@
    \itemindent -2zw % 元: -1.5em
    \listparindent\itemindent
    \rightmargin \z@
    \advance\leftmargin 2zw}% 元: 1.5em
  \item\relax}{\endlist}
\newenvironment{quotation}{%
  \list{}{%
    \listparindent\parindent
    \itemindent\listparindent
    \rightmargin \z@}%
  \item\relax}{\endlist}
\newenvironment{quote}%
  {\list{}{\rightmargin\z@}\item\relax}{\endlist}
\def\@begintheorem#1#2{\trivlist
   \item[\hskip \labelsep{\bfseries #1\ #2}]}
\def\@opargbegintheorem#1#2#3{\trivlist
      \item[\hskip \labelsep{\bfseries #1\ #2\ (#3)}]}
\newenvironment{titlepage}{%
    \cleardoublepage
    \if@twocolumn
      \@restonecoltrue\onecolumn
    \else
      \@restonecolfalse\newpage
    \fi
    \thispagestyle{empty}%
    \setcounter{page}\@ne
  }%
  {\if@restonecol\twocolumn \else \newpage \fi
    \if@twoside\else
      \setcounter{page}\@ne
    \fi}
\newcommand{\appendix}{\par
  \setcounter{chapter}{0}%
  \setcounter{section}{0}%
  \gdef\@chapapp{\appendixname}%
  \gdef\@chappos{}%
  \gdef\thechapter{\@Alph\c@chapter}}
\setlength\arraycolsep{5\p@}
\setlength\tabcolsep{6\p@}
\setlength\arrayrulewidth{.4\p@}
\setlength\doublerulesep{2\p@}
\setlength\tabbingsep{\labelsep}
\skip\@mpfootins = \skip\footins
\setlength\fboxsep{3\p@}
\setlength\fboxrule{.4\p@}
\@addtoreset{equation}{chapter}
\renewcommand\theequation
  {\ifnum \c@chapter>\z@ \thechapter.\fi \@arabic\c@equation}
\newcounter{figure}[chapter]
\renewcommand \thefigure
%     {\ifnum \c@chapter>\z@ \thechapter.\fi \@arabic\c@figure}
     {\@arabic\c@figure} % *UTMC* by Orios [2008-06-07]
\def\fps@figure{tbp}
\def\ftype@figure{1}
\def\ext@figure{lof}
\def\fnum@figure{\figurename\nobreak\thefigure}
\newenvironment{figure}%
               {\@float{figure}}%
               {\end@float}
\newenvironment{figure*}%
               {\@dblfloat{figure}}%
               {\end@dblfloat}
\newcounter{table}[chapter]
\renewcommand \thetable
%     {\ifnum \c@chapter>\z@ \thechapter.\fi \@arabic\c@table}
     {\@arabic\c@table} % *UTMC* by Orios [2008-06-07]
\def\fps@table{tbp}
\def\ftype@table{2}
\def\ext@table{lot}
\def\fnum@table{\tablename\nobreak\thetable}
\newenvironment{table}%
               {\@float{table}}%
               {\end@float}
\newenvironment{table*}%
               {\@dblfloat{table}}%
               {\end@dblfloat}
\newlength\abovecaptionskip
\newlength\belowcaptionskip
\setlength\abovecaptionskip{5\p@} % 元: 10\p@
\setlength\belowcaptionskip{5\p@} % 元: 0\p@
\long\def\@makecaption#1#2{{\small
%  \advance\leftskip1cm
%  \advance\rightskip1cm % *UTMC*
  \advance\leftskip3mm
  \advance\rightskip3mm
  \vskip\abovecaptionskip
  \sbox\@tempboxa{#1\hskip1zw\relax #2}%
  \ifdim \wd\@tempboxa <\hsize \centering \fi
  #1\hskip1zw\relax #2\par
  \vskip\belowcaptionskip}}
\DeclareOldFontCommand{\mc}{\normalfont\mcfamily}{\mathmc}
\DeclareOldFontCommand{\gt}{\normalfont\gtfamily}{\mathgt}
\DeclareOldFontCommand{\rm}{\normalfont\rmfamily}{\mathrm}
\DeclareOldFontCommand{\sf}{\normalfont\sffamily}{\mathsf}
\DeclareOldFontCommand{\tt}{\normalfont\ttfamily}{\mathtt}
\DeclareOldFontCommand{\bf}{\normalfont\bfseries}{\mathbf}
\DeclareOldFontCommand{\it}{\normalfont\itshape}{\mathit}
\DeclareOldFontCommand{\sl}{\normalfont\slshape}{\@nomath\sl}
\DeclareOldFontCommand{\sc}{\normalfont\scshape}{\@nomath\sc}
\DeclareRobustCommand*{\cal}{\@fontswitch\relax\mathcal}
\DeclareRobustCommand*{\mit}{\@fontswitch\relax\mathnormal}
\newcommand\@pnumwidth{1.55em}
\newcommand\@tocrmarg{2.55em}
\newcommand\@dotsep{4.5}
\setcounter{tocdepth}{1}
\newcommand{\tableofcontents}{%
  \if@twocolumn
    \@restonecoltrue\onecolumn
  \else
    \@restonecolfalse
  \fi
  \chapter*{\contentsname
    \@mkboth{\contentsname}{\contentsname}}%
  \@starttoc{toc}%
  \if@restonecol\twocolumn\fi
}
\newcommand*{\l@part}[2]{%
  \ifnum \c@tocdepth >-2\relax
    \addpenalty{-\@highpenalty}%
    \addvspace{2.25em \@plus\p@}%
    \begingroup
      \parindent \z@
      \rightskip \@tocrmarg
      \parfillskip -\rightskip
      {\leavevmode
        \large \headfont
        \setlength\@lnumwidth{4zw}%
        #1\hfil \hb@xt@\@pnumwidth{\hss #2}}\par
      \nobreak
    \global\@nobreaktrue
    \everypar{\global\@nobreakfalse\everypar{}}%
    \endgroup
  \fi}
\newcommand*{\l@chapter}[2]{%
  \ifnum \c@tocdepth >\m@ne
    \addpenalty{-\@highpenalty}%
    \addvspace{1.0em \@plus\p@}
    \begingroup
      \parindent\z@
      \rightskip\@tocrmarg
      \parfillskip-\rightskip
      \leavevmode\headfont
      %\raggedright
      \setlength\@lnumwidth{1.5zw}% *UTMC* Was: 4.683zw, Modified by Orios [08-05-17]
      \advance\leftskip\@lnumwidth \hskip-\leftskip
      %\tolerance=10000
      #1\nobreak\hfil\nobreak\hbox to\@pnumwidth{\hss#2}\par
      \penalty\@highpenalty
    \endgroup
  \fi}
%\newcommand*{\l@section}{\@dottedtocline{1}{1zw}{3.683zw}}
\if@nidantoc % *UTMC*
  \newcommand*{\l@section}{\@dottedtocline{1}{.8zw}{1.683zw}}
\else
  \newcommand*{\l@section}{\@dottedtocline{1}{1zw}{3.683zw}}
\fi
\newcommand*{\l@subsection}   {\@dottedtocline{2}{3.8em}{3.2em}}
\newcommand*{\l@subsubsection}{\@dottedtocline{3}{7.0em}{4.1em}}
\newcommand*{\l@paragraph}    {\@dottedtocline{4}{10em}{5em}}
\newcommand*{\l@subparagraph} {\@dottedtocline{5}{12em}{6em}}
\newdimen\@lnumwidth
\def\numberline#1{\hb@xt@\@lnumwidth{#1\hfil}\hspace{0pt}}
\def\@dottedtocline#1#2#3#4#5{\ifnum #1>\c@tocdepth \else
  \vskip \z@ \@plus.2\p@
  {\leftskip #2\relax \rightskip \@tocrmarg \parfillskip -\rightskip
    \parindent #2\relax\@afterindenttrue
   \interlinepenalty\@M
   \leavevmode
   \@lnumwidth #3\relax
   \advance\leftskip \@lnumwidth \null\nobreak\hskip -\leftskip
    {#4}\nobreak
%    \leaders\hbox{$\m@th \mkern \@dotsep mu\hbox{.}\mkern \@dotsep % *UTMC*
    \leaders\hbox{$\m@th \,\hbox{.}\mkern \@dotsep
       mu$}\hfill \nobreak\hb@xt@\@pnumwidth{%
         \hfil\normalfont \normalcolor #5}\par}\fi}
\newcommand{\listoffigures}{%
  \if@twocolumn\@restonecoltrue\onecolumn
  \else\@restonecolfalse\fi
  \chapter*{\listfigurename
  \@mkboth{\listfigurename}{\listfigurename}}%
  \@starttoc{lof}%
  \if@restonecol\twocolumn\fi
}
\newcommand*{\l@figure}{\@dottedtocline{1}{1.5em}{2.3em}}
\newcommand{\listoftables}{%
  \if@twocolumn\@restonecoltrue\onecolumn
  \else\@restonecolfalse\fi
  \chapter*{\listtablename
  \@mkboth{\listtablename}{\listtablename}}%
  \@starttoc{lot}%
  \if@restonecol\twocolumn\fi
}
\let\l@table\l@figure
\newdimen\bibindent
\setlength\bibindent{2zw}
\newenvironment{thebibliography}[1]{%
  \global\let\presectionname\relax
  \global\let\postsectionname\relax
  \chapter*{\bibname\@mkboth{\bibname}{\bibname}}%
  \addcontentsline{toc}{chapter}{\bibname}%
   \list{\@biblabel{\@arabic\c@enumiv}}%
        {\settowidth\labelwidth{\@biblabel{#1}}%
         \leftmargin\labelwidth
         \advance\leftmargin\labelsep
         \@openbib@code
         \usecounter{enumiv}%
         \let\p@enumiv\@empty
         \renewcommand\theenumiv{\@arabic\c@enumiv}}%
   \sloppy
   \clubpenalty4000
   \@clubpenalty\clubpenalty
   \widowpenalty4000%
   \sfcode`\.\@m}
  {\def\@noitemerr
    {\@latex@warning{Empty `thebibliography' environment}}%
   \endlist}
\newcommand{\newblock}{\hskip .11em\@plus.33em\@minus.07em}
\let\@openbib@code\@empty
\newenvironment{theindex}{% 索引を3段組で出力する環境
    \if@twocolumn
      \onecolumn\@restonecolfalse
    \else
      \clearpage\@restonecoltrue
    \fi
    \columnseprule.4pt \columnsep 2zw
    \ifx\multicols\@undefined
      \twocolumn[\@makeschapterhead{\indexname}%
      \addcontentsline{toc}{chapter}{\indexname}]%
    \else
      \ifdim\textwidth<\fullwidth
        \setlength{\evensidemargin}{\oddsidemargin}
        \setlength{\textwidth}{\fullwidth}
        \setlength{\linewidth}{\fullwidth}
        \begin{multicols}{3}[\chapter*{\indexname}%
        \addcontentsline{toc}{chapter}{\indexname}]%
      \else
        \begin{multicols}{2}[\chapter*{\indexname}%
        \addcontentsline{toc}{chapter}{\indexname}]%
      \fi
    \fi
    \@mkboth{\indexname}{\indexname}%
    \plainifnotempty % \thispagestyle{plain}
    \parindent\z@
    \parskip\z@ \@plus .3\p@\relax
    \let\item\@idxitem
    \raggedright
    \footnotesize\narrowbaselines
  }{
    \ifx\multicols\@undefined
      \if@restonecol\onecolumn\fi
    \else
      \end{multicols}
    \fi
    \clearpage
  }
\newcommand{\@idxitem}{\par\hangindent 4zw} % 元 40pt
\newcommand{\subitem}{\@idxitem \hspace*{2zw}} % 元 20pt
\newcommand{\subsubitem}{\@idxitem \hspace*{3zw}} % 元 30pt
\newcommand{\indexspace}{\par \vskip 10\p@ \@plus5\p@ \@minus3\p@\relax}
\newcommand\seename{\if@english see\else →\fi}
\newcommand\alsoname{\if@english see also\else →\fi}
\let\footnotes@ve=\footnote
\def\footnote{\inhibitglue\footnotes@ve}
\let\footnotemarks@ve=\footnotemark
\def\footnotemark{\inhibitglue\footnotemarks@ve}
\def\thefootnote{\ifnum\c@footnote>\z@\leavevmode\lower.5ex\hbox{*}\@arabic\c@footnote\fi}
\renewcommand{\footnoterule}{%
  \kern-3\p@
  \hrule width .4\columnwidth
  \kern 2.6\p@}
\@addtoreset{footnote}{chapter}
\long\def\@footnotetext{%
  \insert\footins\bgroup
    \normalfont\footnotesize
    \interlinepenalty\interfootnotelinepenalty
    \splittopskip\footnotesep
    \splitmaxdepth \dp\strutbox \floatingpenalty \@MM
    \hsize\columnwidth \@parboxrestore
    \protected@edef\@currentlabel{%
       \csname p@footnote\endcsname\@thefnmark
    }%
    \color@begingroup
      \@makefntext{%
        \rule\z@\footnotesep\ignorespaces}%
      \futurelet\next\fo@t}
\def\fo@t{\ifcat\bgroup\noexpand\next \let\next\f@@t
                                \else \let\next\f@t\fi \next}
\def\f@@t{\bgroup\aftergroup\@foot\let\next}
\def\f@t#1{#1\@foot}
\def\@foot{\@finalstrut\strutbox\color@endgroup\egroup}
\newcommand\@makefntext[1]{%
  \advance\leftskip 3zw
  \parindent 1zw
  \noindent
  \llap{\@makefnmark\hskip0.3zw}#1}
\def\@inhibitglue{%
  \futurelet\@let@token\@@inhibitglue}
\def\@@inhibitglue{%
  \ifx\@let@token「
    \inhibitglue
  \else
    \ifx\@let@token（
      \inhibitglue
    \else
      \ifx\@let@token『
        \inhibitglue
      \else
        \ifx\@let@token［
          \inhibitglue
        \fi
      \fi
    \fi
  \fi}
\let\everyparhook=\@inhibitglue
\AtBeginDocument{\everypar{\everyparhook}}
\def\@doendpe{%
  \@endpetrue
  \def\par{%
    \@restorepar\everypar{\everyparhook}\par\@endpefalse}%
  \everypar{{\setbox\z@\lastbox}\everypar{\everyparhook}\@endpefalse\everyparhook}}
\def\@item[#1]{%
  \if@noparitem
    \@donoparitem
  \else
    \if@inlabel
      \indent \par
    \fi
    \ifhmode
      \unskip\unskip \par
    \fi
    \if@newlist
      \if@nobreak
        \@nbitem
      \else
        \addpenalty\@beginparpenalty
        \addvspace\@topsep
        \addvspace{-\parskip}%
      \fi
    \else
      \addpenalty\@itempenalty
      \addvspace\itemsep
    \fi
    \global\@inlabeltrue
  \fi
  \everypar{%
    \@minipagefalse
    \global\@newlistfalse
    \if@inlabel
      \global\@inlabelfalse
      {\setbox\z@\lastbox
       \ifvoid\z@
         \kern-\itemindent
       \fi}%
      \box\@labels
      \penalty\z@
    \fi
    \if@nobreak
      \@nobreakfalse
      \clubpenalty \@M
    \else
      \clubpenalty \@clubpenalty
      \everypar{\everyparhook}%
    \fi\everyparhook}%
  \if@noitemarg
    \@noitemargfalse
    \if@nmbrlist
      \refstepcounter\@listctr
    \fi
  \fi
  \sbox\@tempboxa{\makelabel{#1}}%
  \global\setbox\@labels\hbox{%
    \unhbox\@labels
    \hskip \itemindent
    \hskip -\labelwidth
    \hskip -\labelsep
    \ifdim \wd\@tempboxa >\labelwidth
      \box\@tempboxa
    \else
      \hbox to\labelwidth {\unhbox\@tempboxa}%
    \fi
    \hskip \labelsep}%
  \ignorespaces}
\def\@afterheading{%
  \@nobreaktrue
  \everypar{%
    \if@nobreak
      \@nobreakfalse
      \clubpenalty \@M
      \if@afterindent \else
        {\setbox\z@\lastbox}%
      \fi
    \else
      \clubpenalty \@clubpenalty
      \everypar{\everyparhook}%
    \fi\everyparhook}}
\def\@gnewline #1{%
  \ifvmode
    \@nolnerr
  \else
    \unskip \reserved@e {\reserved@f#1}\nobreak \hfil \break \null
    \inhibitglue \ignorespaces
  \fi}
\def\小#1{\hbox{$\m@th$%
  \csname S@\f@size\endcsname
  \fontsize\sf@size\z@
  \math@fontsfalse\selectfont
  #1}}
\def\上小#1{{\sbox\z@ T\vbox to\ht0{\小{#1}\vss}}}
\def\cmrTeX{%
  \ifdim \fontdimen\@ne\font >\z@
    T\kern-.25em\lower.5ex\hbox{E}\kern-.125emX\@
  \else
    T\kern-.1667em\lower.5ex\hbox{E}\kern-.125emX\@
  \fi}
\def\cmrLaTeX{%
  \ifdim \fontdimen\@ne\font >\z@
    L\kern-.32em\上小{A}\kern-.22em\cmrTeX
  \else
    L\kern-.36em\上小{A}\kern-.15em\cmrTeX
  \fi}
\def\sfTeX{T\kern-.1em\lower.4ex\hbox{E}\kern-.07emX\@}
\def\sfLaTeX{L\kern-.25em\上小{A}\kern-.08em\sfTeX}
\def\ptmTeX{%
  \ifdim \fontdimen\@ne\font >\z@
    T\kern-.12em\lower.37ex\hbox{E}\kern-.02emX\@
  \else
    T\kern-.07em\lower.37ex\hbox{E}\kern-.05emX\@
  \fi}
\def\ptmLaTeX{%
  \ifdim \fontdimen\@ne\font >\z@
    L\kern-.2em\上小{A}\kern-.1em\ptmTeX
  \else
    L\kern-.3em\上小{A}\kern-.1em\ptmTeX
  \fi}
\def\pncTeX{%
  \ifdim \fontdimen\@ne\font >\z@
    T\kern-.2em\lower.5ex\hbox{E}\kern-.08emX\@
  \else
    T\kern-.13em\lower.5ex\hbox{E}\kern-.13emX\@
  \fi}
\def\pncLaTeX{%
  \ifdim \fontdimen\@ne\font >\z@
    L\kern-.3em\上小{A}\kern-.1em\pncTeX
  \else
    L\kern-.3em\上小{A}\kern-.1em\pncTeX
  \fi}
\def\pplTeX{%
  \ifdim \fontdimen\@ne\font >\z@
    T\kern-.17em\lower.32ex\hbox{E}\kern-.15emX\@
  \else
    T\kern-.12em\lower.34ex\hbox{E}\kern-.1emX\@
  \fi}
\def\pplLaTeX{%
  \ifdim \fontdimen\@ne\font >\z@
    L\kern-.27em\上小{A}\kern-.12em\pplTeX
  \else
    L\kern-.3em\上小{A}\kern-.15em\pplTeX
  \fi}
\DeclareRobustCommand{\TeX}{%
  \def\@tempa{cmr}%
  \ifx\f@family\@tempa\cmrTeX
  \else
    \def\@tempa{ptm}%
    \ifx\f@family\@tempa\ptmTeX
    \else
      \def\@tempa{txr}%
      \ifx\f@family\@tempa\ptmTeX
      \else
        \def\@tempa{pnc}%
        \ifx\f@family\@tempa\pncTeX
        \else
          \def\@tempa{ppl}%
          \ifx\f@family\@tempa\pplTeX
          \else\sfTeX
          \fi
        \fi
      \fi
    \fi
  \fi}

\DeclareRobustCommand{\LaTeX}{%
  \def\@tempa{cmr}%
  \ifx\f@family\@tempa\cmrLaTeX
  \else
    \def\@tempa{ptm}%
    \ifx\f@family\@tempa\ptmLaTeX
    \else
      \def\@tempa{txr}%
      \ifx\f@family\@tempa\ptmLaTeX
      \else
        \def\@tempa{pnc}%
        \ifx\f@family\@tempa\pncLaTeX
        \else
          \def\@tempa{ppl}%
          \ifx\f@family\@tempa\pplLaTeX
          \else\sfLaTeX
          \fi
        \fi
      \fi
    \fi
  \fi}
\DeclareRobustCommand{\LaTeXe}{$\mbox{%
  \if b\expandafter\@car\f@series\@nil\boldmath\fi
  \LaTeX\kern.15em2\raisebox{-.37ex}{$\textstyle\varepsilon$}}$}
\def\pTeX{p\kern-.05em\TeX}
\def\pLaTeX{p\LaTeX}
\def\pLaTeXe{p\LaTeXe}
\def\AmSTeX{\protect\AmS-\protect\TeX{}}
\DeclareRobustCommand{\BibTeX}{B\kern-.05em\小{I\kern-.025em B}%
  \ifx\f@family\cmr\kern-.08em\else\kern-.15em\fi\TeX}
\DeclareRobustCommand{\SliTeX}{%
  S\kern-.06emL\kern-.18em\上小{I}\kern -.03em\TeX}
\let\ltx@ifnextchar\@ifnextchar
\def\ProvidesFile#1{%
  \begingroup
    \catcode`\ 10 %
    \ifnum \endlinechar<256 %
      \ifnum \endlinechar>\m@ne
        \catcode\endlinechar 10 %
      \fi
    \fi
    \@makeother\/%
    \@makeother\&%
    \ltx@ifnextchar[{\@providesfile{#1}}{\@providesfile{#1}[]}}
\newcommand{\prepartname}{\if@english Part~\else 第\fi}
\newcommand{\postpartname}{\if@english\else 部\fi}
%\newcommand{\prechaptername}{\if@english Chapter~\else 第\fi} % *UTMC*
\newcommand{\prechaptername}{}
%\newcommand{\postchaptername}{\if@english\else 章\fi} % *UTMC*
\newcommand{\postchaptername}{}
\newcommand{\presectionname}{}%  第
\newcommand{\postsectionname}{}% 節
%\newcommand{\contentsname}{\if@english Contents\else 目次\fi} % *UTMC*
\newcommand{\contentsname}{$\vartriangleright$も~く~じ$\vartriangleleft$}
\newcommand{\listfigurename}{\if@english List of Figures\else 図目次\fi}
\newcommand{\listtablename}{\if@english List of Tables\else 表目次\fi}
\newcommand{\refname}{\if@english References\else 参考文献\fi}
\newcommand{\bibname}{\if@english Bibliography\else 参考文献\fi}
\newcommand{\indexname}{\if@english Index\else 索引\fi}
\newcommand{\figurename}{\if@english Fig.~\else 図\fi}
\newcommand{\tablename}{\if@english Table.~\else 表\fi}
\newcommand{\appendixname}{\if@english Appendix~\else 付録\fi}
\newif\if西暦 \西暦true
\def\西暦{\西暦true}
\def\和暦{\西暦false}
\newcount\heisei \heisei\year \advance\heisei-1988\relax
\def\today{%
  \if@english
    \ifcase\month\or
      January\or February\or March\or April\or May\or June\or
      July\or August\or September\or October\or November\or December\fi
      \space\number\day, \number\year
  \else
    \if西暦
      \number\year 年
      \number\month 月
      \number\day 日
    \else
      平成\number\heisei 年
      \number\month 月
      \number\day 日
    \fi
  \fi}
\hyphenation{ado-be post-script ghost-script phe-nom-e-no-log-i-cal man-u-script}
\pagestyle{headings}
\pagenumbering{arabic}
\if@twocolumn
  \twocolumn
  \sloppy
  \flushbottom
\else
  \onecolumn
  \raggedbottom
\fi

% 電子化の面倒な図や表を、印刷したマスターに直に貼りこむときの目印の枠を用意する。
% Usage: \makespace{縦<mm>}{横<mm>}
\newcommand\makespace[2]{
    \setlength{unitlength}{1truemm} % (#1,#2) に使われる単位
    \begin{center}
        \fbox{% framed な box を作る
            \begin{picture}(#1,#2) \end{picture}% #1 mm x #2 mmの広さのpicture領域を確保
        }
    \end{center}
}

% ローマ数字のマクロ
\newcounter{UTMCROMAN}
\newcommand\ROMAN[1]{
  \setcounter{UTMCROMAN}{#1}
  \Roman{UTMCROMAN}
}

\def\partname{hananakajimamasarufujiyamaokometsubu}

%原稿にタイトル等を付ける
%<Usage:\genkoutitle{*原稿の分類}{タイトル}{サブタイトル}{筆者名}{筆者名の読み<ローマ字で>または別名定義}>
\newcommand\OLDgenkoutitle[5]{
    \newpage
    \def\thispartname{#1}
    \def\aliasname{#5}
    \def\subtitle{#3}
    \ifx\partname\thispartname
      \else\ifx\thispartname\@empty
        \else
        \stepcounter{part}
      \fi
    \fi
    \stepcounter{chapter}
    \begingroup
      \begin{center}
        {\Large \bf\gt #2}
      \end{center}
      \ifx\subtitle\@empty
      \vspace{.4cm}
      \else
      \vspace{.4cm}
        \begin{center}
          {#3}
        \end{center}
      \fi
        \vspace{.5cm}
      {\rule{\the\columnwidth}{.5mm}}
      \ifx\aliasname\@empty
        \begin{center}
          {#4}
        \end{center}
        \else
        \begin{center}
          {#4 \ (#5)}
        \end{center}
      \fi
      \vspace{1cm}
    \endgroup
    \markboth%
      {UTMCpress・\number\year\,・\number\month\,}{#1　#2}
    \ifx\partname\thispartname
      \else\ifx\thispartname\@empty
        \else
        \addcontentsline{toc}{part}{\protect\makebox[5cm][l]{#1}}
      \fi
    \fi
    \addcontentsline{toc}{chapter}%
    {\protect\makebox[5cm][l]{#2}{\protect\makebox[5cm][r]{#4}}}
%    {\protect{\makebox[5cm][l]{#2}}\protect{\makebox[5cm][r]{#4}}}
% ここでエラーが出てた  - ixtl
    \let\partname=\thispartname
    \setcounter{footnote}{0}
    \setcounter{figure}{0}
    \setcounter{table}{0}
    \normalsize
    % 標準のsection等のフォーマット。
    % これで各ドキュメントでsection等のナンバリング方法を変更してもばっちり。
    \renewcommand{\thepart}{\@Roman\c@part}
    \renewcommand{\thechapter}{\@arabic\c@chapter}
    \renewcommand{\thesection}{\@arabic\c@section}% *UTMC* Was: \thechapter.\@arabic\c@section
    \renewcommand{\thesubsection}{\thesection.\@arabic\c@subsection}
    \renewcommand{\thesubsubsection}{%
       \thesubsection.\@arabic\c@subsubsection}
    \renewcommand{\theparagraph}{%
       \thesubsubsection.\@arabic\c@paragraph}
    \renewcommand{\thesubparagraph}{%
       \theparagraph.\@arabic\c@subparagraph}
}

\newcommand{\utmctableofcontents}{%
  \newif\iftmp@openright
  \if@openright \tmp@openrighttrue \@openrightfalse \else \tmp@openrightfalse \fi
  \if@nidantoc
    \if@twocolumn
      \@restonecolfalse
    \else
      \@restonecoltrue\twocolumn
    \fi
    \chapter*{\contentsname
      \@mkboth{\contentsname}{\contentsname}}%
{   \tolerance=10000
    \raggedright
    \@starttoc{toc}} % 記事本文の段落が一字下げにならないみたいなので、この部分を{ }で囲みました (2008/03/03 Orios)
    \if@restonecol\onecolumn\fi
  \else
    \if@twocolumn
      \@restonecoltrue\onecolumn
    \else
      \@restonecolfalse
    \fi
    \chapter*{\contentsname
      \@mkboth{\contentsname}{\contentsname}}%
    \@starttoc{toc}%
    \if@restonecol\twocolumn\fi
  \fi
  \iftmp@openright\@openrighttrue\fi
}

\def\utmccaption{%
   \ifx\@captype\@undefined
     \@latex@error{\noexpand\caption outside float}\@ehd
     \expandafter\@gobble
   \else
     \refstepcounter\@captype
     \expandafter\@firstofone
   \fi
   {\@dblarg{\@utmccaption\@captype}}%
}
\long\def\@utmccaption#1[#2]#3{%
  \par
  \addcontentsline{\csname ext@#1\endcsname}{#1}%
    {\protect\numberline{\csname the#1\endcsname}{\ignorespaces #2}}%
  \begingroup
    \@parboxrestore
    \if@minipage
      \@setminipage
    \fi
    \normalsize
    \@utmcmakecaption{\csname fnum@#1\endcsname}{\ignorespaces #3}\par
  \endgroup}
\long\def\@utmcmakecaption#1#2{{\small
%  \advance\leftskip1cm \advance\rightskip1cm % *UTMC*
  \advance\leftskip3mm \advance\rightskip3mm
  \vskip\abovecaptionskip
%  \sbox\@tempboxa{#1\hskip1zw\relax #2}% *UTMC*
  \sbox\@tempboxa{#2}%
  \ifdim \wd\@tempboxa <\hsize \centering \fi
%  #1\hskip1zw\relax #2\par *UTMC*
  #2\par
  \vskip\belowcaptionskip}}

\newcommand{\genkoutitle}{%
  % openrightだと (すなわちopenanyでなければ) 常に奇数ページから始まる
  %\if@openright\cleardoublepage\else\clearpage\fi
  \plainifnotempty % 元: \thispagestyle{plain}
  \global\@topnum\z@
  \secdef\utmc@chapter\@schapter}
\def\utmc@chapter[#1]#2#3#4#5#6{%
  \ifnum \c@secnumdepth >\m@ne
    \if@mainmatter
      \refstepcounter{chapter}%
      \typeout{\@chapapp\thechapter\@chappos}%
      \addcontentsline{toc}{chapter}%
      {\raise.06zw\hbox{\fbox{\arabic{chapter}}}\hskip.5zw#1\hskip 1em plus 10em \penalty 0\mbox{\textrm{---}\,#4}}% Modified by Orios [08-05-17]
      %{#1\hskip 1em plus 10em \penalty 0\mbox{\textrm{---}\,#4}}%
      %{\protect\numberline{\@chapapp\thechapter\@chappos}#1}%
    \else
      \addcontentsline{toc}{chapter}{#1}
    \fi
  \else
    \addcontentsline{toc}{chapter}{#1}%
  \fi
  %\chaptermark{#1\quad ---\,#4}%
  \addtocontents{lof}{\protect\addvspace{10\p@}}%
  \addtocontents{lot}{\protect\addvspace{10\p@}}%
  \if@twocolumn
    \@topnewpage[\@makechapterhead{#2}]%
  \else
    \utmc@makechapterhead[#1]{#2}{#3}{#4}{#5}{#6}%
    \@afterheading
  \fi}

\newlength{\utmc@titleBoxWidth}% \utmc@makechapterhead で使用する距離変数 by Orios [2008-03-09]
\newlength{\utmc@titleBoxHeight}% \utmc@makechapterhead で使用する距離変数 by Orios [2008-03-09]
\newlength{\utmc@title@dim} % 文字長に応じてヘッダの文字幅を変えるときに使う距離変数 by Orios [2008-05-17]
\newlength{\utmc@title@max} % 文字長に応じてヘッダの文字幅を変えるときに使う距離変数 by Orios [2008-05-17]
\newlength{\utmc@title@tmp} % 文字長に応じてヘッダの文字幅を変えるときに使う距離変数 by Orios [2008-05-17]
\def\utmc@makechapterhead[#1]#2#3#4#5#6{%
  % [#1]の有無に応じて目次に表示するものを決める
    \ifx{#1}\@empty % 修正 [2008-03-08]
      \def\utmc@title{#2}%   % [#1]が空なので目次は#2と同じ
    \else
      \def\utmc@title{#1}%   % [#1]に，改行などハックを除いた目次用テキストが指定されている
    \fi
    \def\utmc@showtitle{#2} % 目次などに出力するためのプレーンな文字列
    \def\utmc@subtitle{#3}%
    \def\utmc@writer{#4}%
    \def\utmc@writeralias{#5}%
    \def\utmc@thispartname{#6}%
    %部門名の処理をこっそり追加 by Orios [08-05-17]
    \ifx\utmc@thispartname\@empty
      \def\utmc@writerfortitle{#4}%
    \else
      \def\utmc@writerfortitle{#6::#4}%
    \fi
  {\parindent \z@ \raggedright \normalfont
    \ifnum \c@secnumdepth >\m@ne
      \if@mainmatter
        \newbox\chapterNumberBox%
        \setbox\chapterNumberBox=\hbox{\fontsize{50pt}{60pt}\selectfont ~\textbf{\thechapter}\strut~}%
          %\color{white}\colorbox{black}{~\textbf{\thechapter}\strut~}~}
          {\color{white}\colorbox{black}{\unhcopy\chapterNumberBox}}

        \vspace*{-\ht\chapterNumberBox} \vspace*{-20pt}
        \addtolength{\leftskip}{\wd\chapterNumberBox} \addtolength{\leftskip}{20pt}%

        % 記事タイトル用ボックス
        %   ※ 記事タイトルが2行以上に渡るときの自動処理 by Orios [2008-03-08]
        %   modified by Orios [2008-06-07]
        \setlength{\utmc@titleBoxWidth}{\textwidth}%
        \addtolength{\utmc@titleBoxWidth}{-\leftskip}%
        \def\utmc@chapterTitleBox{\parbox{\utmc@titleBoxWidth}{\Huge\headfont \utmc@showtitle}}%
        \settoheight{\utmc@titleBoxHeight}{\utmc@chapterTitleBox}%
	\setcounter{footnote}{0} % タイトルにfootnoteがあったとき、footnoteの番号がズレるのを防止
        \ifx\utmc@subtitle\@empty % サブタイトルが空
          \ifdim1.5\baselineskip>\utmc@titleBoxHeight% もし記事タイトルが1行のとき
            \vspace*{15pt}%
          \fi
          \Huge\headfont\baselineskip=30pt \utmc@showtitle \par\normalsize\normalfont % {}で囲むと改行幅が変になるので修正 by Orios [2008-06-04]
        \else % サブタイトルがある
          \Huge\headfont\baselineskip=30pt \utmc@showtitle \par\normalsize\normalfont % {}で囲むと改行幅が変になるので修正 by Orios [2008-06-04]
          \bigskip
          \addtolength{\leftskip}{10pt}
          \LARGE\headfont\baselineskip=20pt \utmc@subtitle \par\normalsize\normalfont % {}で囲むと改行幅が変になるので修正 by Orios [2008-06-04]
        \fi

%        \ifx\utmc@showtitle\utmc@title
%          \ifx\utmc@subtitle\@empty % メインタイトルが普通でサブタイトルが空
%            {\Huge\headfont \utmc@showtitle} \par
%          \else % メインタイトルが普通でサブタイトルがある
%            {\Huge\headfont \utmc@showtitle} \par
%            \bigskip
%            \addtolength{\leftskip}{10pt}
%            {\LARGE\headfont \utmc@subtitle}
%          \fi
%        \else
%          \ifx\utmc@subtitle\@empty % メインタイトルが長くてサブタイトルが空
%            \vspace*{-15pt}
%            {\Huge\headfont \utmc@showtitle} \par
%          \else % メインタイトルが長くてサブタイトルがある
%            \vspace*{-15pt}
%            {\Huge\headfont \utmc@showtitle} \par
%            \bigskip
%            \addtolength{\leftskip}{10pt}
%            {\LARGE\headfont \utmc@subtitle}
%            \vspace*{-10pt}
%          \fi
%        \fi
      \fi
    \fi

    \ifx\utmc@writeralias\@empty
        \flushright{\large \utmc@writerfortitle}
    \else
        \flushright{\large \utmc@writerfortitle\quad (\utmc@writeralias)}
    \fi

    \vskip .7\Cvs \hrule \vskip 2\Cvs

    \markboth{UTMC\,Press \issueyear-\issuemonth}{}
    % 記事の長さに応じて文字幅を変える by Orios [08-05-17]
    \settowidth{\utmc@title@dim}{\utmc@title\quad ---\,\utmc@writer}
    \setlength{\utmc@title@max}{0.9\hsize}
    \settowidth{\utmc@title@tmp}{---\,\utmc@writer}
    \advance\utmc@title@max by -\utmc@title@tmp
    \ifdim\utmc@title@dim>2.31\utmc@title@max
      \markright{\hbox{\protect\scalebox{0.390}[1]{\utmc@title}\quad---\,\utmc@writer}}{}%
    \else\ifdim\utmc@title@dim>2.08\utmc@title@max
      \markright{\hbox{\protect\scalebox{0.433}[1]{\utmc@title}\quad---\,\utmc@writer}}{}%
    \else\ifdim\utmc@title@dim>1.87\utmc@title@max
      \markright{\hbox{\protect\scalebox{0.481}[1]{\utmc@title}\quad---\,\utmc@writer}}{}%
    \else\ifdim\utmc@title@dim>1.68\utmc@title@max
      \markright{\hbox{\protect\scalebox{0.536}[1]{\utmc@title}\quad---\,\utmc@writer}}{}%
    \else\ifdim\utmc@title@dim>1.51\utmc@title@max
      \markright{\hbox{\protect\scalebox{0.596}[1]{\utmc@title}\quad---\,\utmc@writer}}{}%
    \else\ifdim\utmc@title@dim>1.36\utmc@title@max
      \markright{\hbox{\protect\scalebox{0.662}[1]{\utmc@title}\quad---\,\utmc@writer}}{}%
    \else\ifdim\utmc@title@dim>1.23\utmc@title@max
      \markright{\hbox{\protect\scalebox{0.732}[1]{\utmc@title}\quad---\,\utmc@writer}}{}%
    \else\ifdim\utmc@title@dim>1.11\utmc@title@max
      \markright{\hbox{\protect\scalebox{0.811}[1]{\utmc@title}\quad---\,\utmc@writer}}{}%
    \else\ifdim\utmc@title@dim>1.00\utmc@title@max
      \markright{\hbox{\protect\scalebox{0.900}[1]{\utmc@title}\quad---\,\utmc@writer}}{}%
    \else
      \markright{\utmc@title\quad ---\,\utmc@writer}{}%
    \fi\fi\fi\fi\fi\fi\fi\fi\fi
    }
}

% ページ全体に画像を貼り付けるマクロ by Orios [2008-05-17, Modified on 2008-12-13]
\newlength{\im@gevoffset}%
\newlength{\im@gehoffset}%
\newcommand{\fullimage}[3][\paperheight]{%
  {\setlength{\im@gevoffset}{-1truein}%
  \addtolength{\im@gevoffset}{-\voffset}%
  \addtolength{\im@gevoffset}{-\topmargin}%
  \addtolength{\im@gevoffset}{-\headheight}%
  \addtolength{\im@gevoffset}{-\headsep}%
  \addtolength{\im@gevoffset}{-\topskip}%
  \addtolength{\im@gevoffset}{-\baselineskip}%
  \vspace*{\im@gevoffset}%
  \setlength{\im@gehoffset}{-1truein}%
  \addtolength{\im@gehoffset}{-\oddsidemargin}%
  \addtolength{\im@gehoffset}{-\hoffset}%
  \unitlength=1truemm
  \noindent\hspace{\im@gehoffset}\begin{picture}(0,0)
    \put(0, -297){\includegraphics[width=\paperwidth, height=#1, #2, clip]{#3}}
  \end{picture}}}

% ページ数調整マクロ by Orios [2008-03-22]
\def\outputextrapage{%
  \newcount\@extrapage
  \@extrapage=\the\c@page
  \advance \@extrapage by \c@prepage
  \divide \@extrapage by 4
  \advance \@extrapage by 1
  \multiply \@extrapage by 4
  \advance \@extrapage by -\c@page
  \advance \@extrapage by -\c@prepage
  \ifnum\the\@extrapage<0
    \advance \@extrapage by 4%
  \fi%
  \ifnum\the\@extrapage=4 % 修正(\ifnum追加) by Orios [2008-05-27]
    \@extrapage=0
  \fi\@outputextrapage}
\def\@outputextrapage{
  \ifnum\the\@extrapage=0 \let\@next=\relax \else
    \noindent Memo:\newpage%
    \advance \@extrapage by -1%
    \let\@next=\@outputextrapage%
  \fi\@next}

% フォント指定 by Orios [2008-11-16]
%   mathptmx だと重力加速度 g の字形が気に入らなかったため、
%   数式フォントは Computer Modern に戻した
\renewcommand{\rmdefault}{ptm} % 2008-11-16追加 by Orios

% 編集担、表紙絵師の名前を登録するマクロ
% Usage: \staffinfo{編集担}{表紙絵師} by hyuga [2009-05-01]
\newcommand{\staffinfo}[2]{%
	\def\editor{#1}%
	\def\hyoshi{#2}%
}

% ソースコードのディレクトリを指定する。 by hyuga [2009-06-02]
\newcommand{\sourcespath}[1]{%
	\def\@sourcespath{#1}%
}
% ソースコード挿入用マクロ。 by hyuga [2009-06-02]
% \lstinputlisting のスタイルが気に入らなければ適当に変えてください。
% \inputsource[caption=キャプション,label=ラベル]{言語名}{ソースコードファイル名}
\newcommand{\inputsource}[3][]{%
	\lstset{%
		language=#2,%
		basicstyle=\ttfamily\scriptsize,%
		commentstyle=\textbf,%
		classoffset=1,%
		keywordstyle=\bfseries,%
		frame=tRBl,%
		framesep=5pt,%
		showstringspaces=false,%
		numbers=left,%
		stepnumber=1,%
		numberstyle=\tiny,%
		tabsize=2%
	}%
	\lstinputlisting[#1]{\@sourcespath/#3}%
}

% 記事を include する。
\newcommand\utmcinclude[1]{%
	% 画像の保存場所を指定
	\graphicspath{{images/#1/}}%
	% ソースコードの保存場所を指定
	\sourcespath{sources/#1/}%
	\include{articles/#1}%
}

\endinput
%%
%% End of file `jsbook.cls'.
